name: Build & Test Project

on:
  push:
    branches-ignore:
      - master
      - develop

jobs:
  api:
    name: 'Build & Test API'
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2
      - uses: n1hility/cancel-previous-runs@v2
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
      - name: 'Build API Image'
        run: |
          docker build ./api --file ./api/Dockerfile
  web:
    name: 'Build & Test Web App'
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2
      - uses: n1hility/cancel-previous-runs@v2
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
      - name: 'Build Web Image'
        run: |
          docker build ./web --file ./web/Dockerfile
